<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üíß –Ø–∫—ñ—Å—Ç—å –≤–æ–¥–∏</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #e3f2fd, #ffffff);
    }
    header {
      background-color: #2196f3;
      color: white;
      text-align: center;
      padding: 20px;
    }
    .content {
      padding: 20px;
    }
    #chartContainer {
      max-width: 600px;
      margin: 0 auto;
    }
    #recommendations {
      margin-top: 20px;
      background: #e1f5fe;
      padding: 15px;
      border-left: 5px solid #039be5;
    }
    #bgToggle {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #2196f3;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    <h1>üíß –Ø–∫—ñ—Å—Ç—å –≤–æ–¥–∏</h1>
    <p>–ì—Ä–∞—Ñ—ñ–∫ –∫–ª—ñ–º–∞—Ç–∏—á–Ω–∏—Ö —É–º–æ–≤ —Ç–∞ –ø–æ—Ä–∞–¥–∏</p>
  </header>

  <div class="content">
    <div id="chartContainer">
      <canvas id="waterChart"></canvas>
    </div>

    <div id="recommendations">
      <h3>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:</h3>
      <ul id="adviceList"></ul>
    </div>

    <button id="bgToggle">üé® –ó–º—ñ–Ω–∏—Ç–∏ —Ñ–æ–Ω</button>
  </div>

  <script>
    const API_KEY = "c0a820cfc0cc46cc51e67536bf08f5e3";

    function getWeatherData(lat, lon) {
      const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric&lang=uk`;
      fetch(url)
        .then(res => res.json())
        .then(data => {
          if (data && data.main) {
            const { temp, humidity, pressure } = data.main;
            new Chart(document.getElementById("waterChart").getContext("2d"), {
              type: "bar",
              data: {
                labels: ["–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞", "–í–æ–ª–æ–≥—ñ—Å—Ç—å", "–¢–∏—Å–∫"],
                datasets: [{
                  label: "–ó–Ω–∞—á–µ–Ω–Ω—è",
                  data: [temp, humidity, pressure],
                  backgroundColor: "#2196f3"
                }]
              },
              options: {
                responsive: true,
                scales: { y: { beginAtZero: true } }
              }
            });

            const rec = [];
            if (humidity < 30) rec.push("üî¥ –ù–∞–¥—Ç–æ –Ω–∏–∑—å–∫–∞ –≤–æ–ª–æ–≥—ñ—Å—Ç—å ‚Äî –ø–∏–π—Ç–µ –±—ñ–ª—å—à–µ –≤–æ–¥–∏");
            else if (humidity > 70) rec.push("üü† –í–∏—Å–æ–∫–∞ –≤–æ–ª–æ–≥—ñ—Å—Ç—å ‚Äî –º–æ–∂–ª–∏–≤–∏–π —Ä–æ–∑–≤–∏—Ç–æ–∫ –±–∞–∫—Ç–µ—Ä—ñ–π —É –≤–æ–¥—ñ");
            else rec.push("üü¢ –û–ø—Ç–∏–º–∞–ª—å–Ω–∞ –≤–æ–ª–æ–≥—ñ—Å—Ç—å ‚Äî –≤–æ–¥–∞ –≤ –Ω–æ—Ä–º—ñ");

            document.getElementById("adviceList").innerHTML = rec.map(r => `<li>${r}</li>`).join("");
          } else {
            alert("–ù–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –¥–∞–Ω–∏—Ö –ø—Ä–æ –∫–ª—ñ–º–∞—Ç.");
          }
        })
        .catch(err => {
          console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö:", err);
          alert("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö.");
        });
    }

    navigator.geolocation.getCurrentPosition(
      pos => getWeatherData(pos.coords.latitude, pos.coords.longitude),
      err => {
        alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–∞—à–µ –º—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è.");
        getWeatherData(50.45, 30.52); // Fallback: –ö–∏—ó–≤
      }
    );

    // üé® –ó–º—ñ–Ω–∞ —Ñ–æ–Ω—É
    const bgToggle = document.getElementById("bgToggle");
    let isDefault = true;
    bgToggle.addEventListener("click", () => {
      document.body.style.background = isDefault
        ? "linear-gradient(135deg, #b3e5fc, #81d4fa)"
        : "linear-gradient(135deg, #e3f2fd, #ffffff)";
      isDefault = !isDefault;
    });
  </script>
</body>
</html>

